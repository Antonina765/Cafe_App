@using Cafe_App.Services
@model IEnumerable<Cafe_App.Models.Cafe.CafeIndexViewModel>

@{
    Layout = "~/Views/Shared/_LayoutCafe.cshtml";
}

@section Styles {
    <link href="~/css/cafe/index.css" rel="stylesheet"/>
}

@section Scripts {
    <script src="~/js/index.js"></script>
}

@foreach (var cafe in Model)
{
    <div class="cafe-container">
        <!-- информация о кафе -->
        <div class="cafes">
            <h2 class="cafe-title">@cafe.Title</h2>
            <img src="@cafe.ImageSrc" alt="Cafe Image" class="cafe-image" />
            <p class="cafe-address">@cafe.Address</p>
            <div class="cafe-stars">
                @for (int i = 0; i < cafe.Rang; i++)
                {
                    <span>★</span>
                }
            </div>
            <p class="cafe-rating">Rating: @cafe.Rang</p>
        </div>

        <div style="text-align: center;">
            @if (ViewBag.IsAdmin == true)
            {
                <button onclick="updateCafeImage(@cafe.CafeId)" class="cafe-button cafe-button-update">Update Image</button>
                <button onclick="updateCafeTitle(@cafe.CafeId)" class="cafe-button cafe-button-update-title">Update Title</button>
                <button onclick="deleteCafe(@cafe.CafeId)" class="cafe-button cafe-button-delete">Delete</button>
            }
            else
            {
                <button onclick="moreInfo(@cafe.CafeId)" class="cafe-button cafe-button-more">More Information</button>
            }
        </div>
    </div>
}

<!-- Модальное окно для обновления названия -->
<div id="titleModal" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closeTitleModal()">×</span>
        <h3>Update Cafe Title</h3>
        <form id="titleForm" method="post" action="/Cafe/UpdateTitle">
            <input type="hidden" id="titleCafeId" name="id" />
            <input type="text" id="newTitle" name="newTitle" placeholder="Enter new title" style="width:100%; padding:8px; margin:8px 0;" />
            <button type="submit" class="cafe-button">Save</button>
        </form>
    </div>
</div>

<!-- Модальное окно для обновления картинки -->
<div id="imageModal" class="modal">
    <div class="modal-content">
        <span class="modal-close" onclick="closeImageModal()">×</span>
        <h3>Update Cafe Image</h3>
        <form id="imageForm" method="post" action="/Cafe/UpdateImage" enctype="multipart/form-data">
            <input type="hidden" id="imageCafeId" name="id" />
            <div>
                <label for="imageFile">Upload Image:</label>
                <input type="file" id="imageFile" name="imageFile" accept="image/*" style="margin:8px 0;" />
            </div>
            <div>
                <label for="imageUrl">or Enter URL:</label>
                <input type="text" id="imageUrl" name="url" placeholder="Image URL" style="width:100%; padding:8px; margin:8px 0;" />
            </div>
            <button type="submit" class="cafe-button">Save</button>
        </form>
    </div>
</div>

<!-- Подключение файла скриптов -->
<script src="~/js/cafe.js"></script>